# ============================================================================
# BatchShort 环境变量配置示例
# ============================================================================
# 复制此文件为 .env 并根据实际情况修改配置值
# ============================================================================

# ============================================================================
# 应用配置
# ============================================================================
APP_NAME=BatchShort1
APP_VERSION=2.0.0
ENVIRONMENT=development  # development | testing | production
DEBUG=false

# 项目根目录 (可选，默认为当前目录)
# BATCHSHORT_BASE_DIR=/path/to/project

# ============================================================================
# 数据库配置
# ============================================================================
# MySQL 数据库连接 URL
DATABASE_URL=mysql+mysqlconnector://root:password@localhost:3306/batchshort

# 数据库连接池配置
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_RECYCLE=3600

# ============================================================================
# Celery 分布式任务队列配置
# ============================================================================
# Celery Broker (使用 Redis)
CELERY_BROKER_URL=redis://localhost:6379/0

# Celery Result Backend (使用 Redis)
CELERY_RESULT_BACKEND=redis://localhost:6379/1

# Worker 并发配置
WORKER_CONCURRENCY=1  # 每个 worker 的并发任务数
WORKER_PREFETCH_MULTIPLIER=1  # 预取倍数

# ============================================================================
# Redis 配置
# ============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=  # 如果有密码

# 完整 Redis URL (覆盖上面的配置)
# REDIS_URL=redis://:password@localhost:6379/0

# ============================================================================
# 阿里云 OSS 配置
# ============================================================================
OSS_ACCESS_KEY_ID=your_access_key_here
OSS_ACCESS_KEY_SECRET=your_secret_key_here
OSS_ENDPOINT=oss-cn-hangzhou.aliyuncs.com
OSS_BUCKET_NAME=your_bucket_name_here

# OSS URL 过期时间 (秒)
OSS_URL_EXPIRATION=3600

# ============================================================================
# JWT 认证配置
# ============================================================================
# JWT 密钥 (必须设置，至少 32 个字符)
ACCESS_SECRET=your-secret-key-must-be-at-least-32-characters-long

# JWT 算法
ACCESS_ALGORITHM=HS256

# Token 过期时间 (分钟)
ACCESS_TOKEN_EXPIRE_MINUTES=60

# ============================================================================
# TTS 服务配置
# ============================================================================
# SeedVC TTS 服务
TTS_SERVER_URL=http://127.0.0.1:8007

# Azure TTS 服务
AZURE_TTS_SERVER_URL=http://127.0.0.1:8008
AZURE_SPEECH_KEY=your_azure_speech_key
AZURE_SPEECH_REGION=eastasia

# ============================================================================
# 图像生成服务配置
# ============================================================================
# Flux 服务
FLUX_SERVER_URL=http://127.0.0.1:8009

# AI 图像生成服务
AI_IMAGE_GEN_API_URL=http://127.0.0.1:8010

# ============================================================================
# 数字人服务配置
# ============================================================================
HUMAN_SERVICE_URL=http://localhost:8308

# ============================================================================
# OCR 服务配置
# ============================================================================
OCR_SERVICE_URL=http://localhost:8222

# ============================================================================
# LLM 服务配置 (可选)
# ============================================================================
LLM_API_KEY=your_llm_api_key
LLM_API_BASE=http://localhost:10001

# ============================================================================
# 后端服务配置
# ============================================================================
BACKEND_SERVER_URL=http://localhost:8006

# CORS 配置
ALLOWED_ORIGINS=["http://localhost:3000", "http://localhost:8080"]
ALLOWED_METHODS=["GET", "POST", "PUT", "DELETE", "OPTIONS"]
ALLOWED_HEADERS=["*"]

# API 配置
API_PREFIX=/api
API_VERSION=v1

# ============================================================================
# Worker 路径配置 (可选)
# ============================================================================
# 如果需要自定义路径，取消注释并设置以下配置
# WORKER_HUMAN_ASSETS_DIR=/path/to/human/assets
# WORKER_HUMAN_CONFIG_PATH=/path/to/human/config.json
# WORKER_FONT_DIR=/path/to/fonts
# WORKER_MODEL_CACHE_DIR=/path/to/models
# WORKER_BG_AUDIO_DIR=/path/to/bg/audio

# ============================================================================
# 日志配置
# ============================================================================
LOG_LEVEL=INFO  # DEBUG | INFO | WARNING | ERROR | CRITICAL
LOG_TO_FILE=true
LOG_DIR=logs

# ============================================================================
# 任务清理配置
# ============================================================================
# 自动清理多少天前的已完成/失败任务
CLEANUP_JOB_DAYS=30

# ============================================================================
# 监控配置 (Flower)
# ============================================================================
# Flower 监控端口
FLOWER_PORT=5555

# Flower 认证 (用户名:密码)
FLOWER_BASIC_AUTH=admin:admin

# ============================================================================
# 开发环境专用配置
# ============================================================================
# 是否启用自动重载 (仅开发环境)
# ENABLE_AUTO_RELOAD=true

# 是否显示 SQL 语句 (仅开发环境)
# SHOW_SQL_QUERIES=true

# ============================================================================
# 监控与可观测性配置
# ============================================================================

# --- Prometheus 指标收集 ---
# 是否启用 Prometheus 指标收集
METRICS_ENABLED=true

# Prometheus 指标服务端口
METRICS_PORT=9090

# --- 分布式链路追踪 ---
# 是否启用分布式追踪
TRACING_ENABLED=false

# 追踪采样率 (0.0 - 1.0)
TRACING_SAMPLE_RATE=0.1

# Jaeger Agent 配置
JAEGER_AGENT_HOST=localhost
JAEGER_AGENT_PORT=6831

# --- 健康检查配置 ---
# 健康检查间隔 (秒)
HEALTH_CHECK_INTERVAL=30

# 健康检查超时 (秒)
HEALTH_CHECK_TIMEOUT=5

# --- 告警配置 ---
# 是否启用告警
ALERTING_ENABLED=false

# AlertManager URL
ALERTMANAGER_URL=http://localhost:9093

# Webhook 告警 URL (可选，多个用逗号分隔)
# ALERT_WEBHOOK_URLS=http://localhost:5000/webhook

# --- 日志聚合 ---
# 是否启用 Loki 日志聚合
LOKI_ENABLED=false

# Loki URL
LOKI_URL=http://localhost:3100

# --- 性能监控阈值 ---
# 慢查询阈值 (秒)
SLOW_QUERY_THRESHOLD=1.0

# 高错误率阈值 (0.0 - 1.0)
HIGH_ERROR_RATE_THRESHOLD=0.05

# 高延迟阈值 (秒)
HIGH_LATENCY_THRESHOLD=5.0

# 内存使用警告阈值 (0.0 - 1.0)
MEMORY_USAGE_WARNING_THRESHOLD=0.8

# CPU 使用警告阈值 (0.0 - 1.0)
CPU_USAGE_WARNING_THRESHOLD=0.8
